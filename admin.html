<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–º–æ–µ—á–∫–∞ ‚Äî –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å üóëÔ∏è</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { font-family: 'Inter', sans-serif; }
        .sidebar { transition: transform 0.3s ease; }
        .sidebar.collapsed { transform: translateX(-100%); }
        @media (min-width: 1024px) {
            .sidebar.collapsed { transform: translateX(0); }
        }
        .stat-card { transition: all 0.2s ease; }
        .stat-card:hover { transform: translateY(-2px); box-shadow: 0 10px 40px rgba(0,0,0,0.1); }
        .table-row:hover { background: #f9fafb; }
        .status-badge { padding: 4px 12px; border-radius: 9999px; font-size: 12px; font-weight: 600; }
        .status-active { background: #d1fae5; color: #065f46; }
        .status-taken { background: #e0e7ff; color: #3730a3; }
        .status-expired { background: #fef3c7; color: #92400e; }
        .status-pending { background: #fef3c7; color: #92400e; }
        .status-resolved { background: #d1fae5; color: #065f46; }
        .status-rejected { background: #fee2e2; color: #991b1b; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar fixed inset-y-0 left-0 z-50 w-64 bg-gray-900 text-white lg:translate-x-0">
        <div class="flex items-center gap-3 p-6 border-b border-gray-800">
            <span class="text-3xl">üóëÔ∏è</span>
            <div>
                <h1 class="font-bold text-lg">–ü–æ–º–æ–µ—á–∫–∞</h1>
                <p class="text-xs text-gray-400">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</p>
            </div>
        </div>
        
        <nav class="p-4 space-y-1">
            <a href="#dashboard" onclick="showSection('dashboard')" class="nav-link flex items-center gap-3 px-4 py-3 rounded-lg bg-emerald-600 text-white">
                <span>üìä</span> –î–∞—à–±–æ—Ä–¥
            </a>
            <a href="#items" onclick="showSection('items')" class="nav-link flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white">
                <span>üì¶</span> –û–±—ä—è–≤–ª–µ–Ω–∏—è
            </a>
            <a href="#users" onclick="showSection('users')" class="nav-link flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white">
                <span>üë•</span> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
            </a>
            <a href="#reports" onclick="showSection('reports')" class="nav-link flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white">
                <span>‚ö†Ô∏è</span> –ñ–∞–ª–æ–±—ã
            </a>
            <a href="#settings" onclick="showSection('settings')" class="nav-link flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white">
                <span>‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
            </a>
        </nav>
        
        <div class="absolute bottom-0 left-0 right-0 p-4 border-t border-gray-800">
            <a href="index.html" class="flex items-center gap-3 px-4 py-3 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white">
                <span>üì±</span> –ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é
            </a>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="lg:ml-64 min-h-screen">
        
        <!-- Header -->
        <header class="bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between sticky top-0 z-40">
            <div class="flex items-center gap-4">
                <button onclick="toggleSidebar()" class="lg:hidden text-gray-600 text-2xl">‚ò∞</button>
                <h2 id="sectionTitle" class="text-xl font-bold text-gray-800">üìä –î–∞—à–±–æ—Ä–¥</h2>
            </div>
            <div class="flex items-center gap-4">
                <span class="text-sm text-gray-500" id="lastUpdate">–û–±–Ω–æ–≤–ª–µ–Ω–æ: —Å–µ–π—á–∞—Å</span>
                <button onclick="refreshData()" class="px-4 py-2 bg-emerald-500 text-white rounded-lg text-sm font-semibold hover:bg-emerald-600">
                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
        </header>

        <!-- Dashboard Section -->
        <section id="section-dashboard" class="p-6">
            
            <!-- Stats Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="stat-card bg-white rounded-2xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <span class="text-3xl">üì¶</span>
                        <span class="text-xs text-emerald-600 bg-emerald-100 px-2 py-1 rounded-full">+12%</span>
                    </div>
                    <p class="text-3xl font-bold text-gray-800" id="stat-items">0</p>
                    <p class="text-sm text-gray-500">–í—Å–µ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–π</p>
                </div>
                
                <div class="stat-card bg-white rounded-2xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <span class="text-3xl">‚úÖ</span>
                        <span class="text-xs text-emerald-600 bg-emerald-100 px-2 py-1 rounded-full">+8%</span>
                    </div>
                    <p class="text-3xl font-bold text-gray-800" id="stat-taken">0</p>
                    <p class="text-sm text-gray-500">–ó–∞–±—Ä–∞–ª–∏</p>
                </div>
                
                <div class="stat-card bg-white rounded-2xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <span class="text-3xl">üë•</span>
                        <span class="text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded-full">+5</span>
                    </div>
                    <p class="text-3xl font-bold text-gray-800" id="stat-users">0</p>
                    <p class="text-sm text-gray-500">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
                </div>
                
                <div class="stat-card bg-white rounded-2xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <span class="text-3xl">‚ôªÔ∏è</span>
                        <span class="text-xs text-green-600 bg-green-100 px-2 py-1 rounded-full">–≠–∫–æ!</span>
                    </div>
                    <p class="text-3xl font-bold text-gray-800"><span id="stat-saved">0</span> –∫–≥</p>
                    <p class="text-sm text-gray-500">–°–ø–∞—Å–µ–Ω–æ –æ—Ç —Å–≤–∞–ª–∫–∏</p>
                </div>
            </div>
            
            <!-- Charts Row -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <div class="bg-white rounded-2xl p-6 shadow-sm">
                    <h3 class="font-bold text-gray-800 mb-4">üìà –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞ –Ω–µ–¥–µ–ª—é</h3>
                    <canvas id="activityChart" height="200"></canvas>
                </div>
                
                <div class="bg-white rounded-2xl p-6 shadow-sm">
                    <h3 class="font-bold text-gray-800 mb-4">üè∑Ô∏è –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
                    <canvas id="categoriesChart" height="200"></canvas>
                </div>
            </div>
            
            <!-- Recent Activity -->
            <div class="bg-white rounded-2xl p-6 shadow-sm">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="font-bold text-gray-800">üïê –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                    <a href="#items" onclick="showSection('items')" class="text-emerald-600 text-sm font-semibold">–í—Å–µ ‚Üí</a>
                </div>
                <div id="recentActivity" class="space-y-3">
                    <!-- Filled by JS -->
                </div>
            </div>
            
        </section>

        <!-- Items Section -->
        <section id="section-items" class="p-6 hidden">
            
            <!-- Filters -->
            <div class="bg-white rounded-2xl p-4 shadow-sm mb-6 flex flex-wrap gap-4 items-center">
                <input type="text" id="itemSearch" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..." 
                       class="flex-1 min-w-[200px] px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500"
                       oninput="filterItems()">
                
                <select id="itemStatus" class="px-4 py-2 border border-gray-200 rounded-lg" onchange="filterItems()">
                    <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                    <option value="active">üü¢ –ê–∫—Ç–∏–≤–Ω—ã–µ</option>
                    <option value="taken">‚úÖ –ó–∞–±—Ä–∞–ª–∏</option>
                    <option value="expired">‚è∞ –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</option>
                </select>
                
                <select id="itemCategory" class="px-4 py-2 border border-gray-200 rounded-lg" onchange="filterItems()">
                    <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                    <option value="furniture">üõãÔ∏è –ú–µ–±–µ–ª—å</option>
                    <option value="construction">üß± –°—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã</option>
                    <option value="electronics">üì∫ –¢–µ—Ö–Ω–∏–∫–∞</option>
                    <option value="books">üìö –ö–Ω–∏–≥–∏</option>
                    <option value="plants">ü™¥ –†–∞—Å—Ç–µ–Ω–∏—è</option>
                    <option value="other">üì¶ –ü—Ä–æ—á–µ–µ</option>
                </select>
                
                <button onclick="exportItems()" class="px-4 py-2 bg-gray-100 rounded-lg text-sm font-semibold hover:bg-gray-200">
                    üì• –≠–∫—Å–ø–æ—Ä—Ç
                </button>
            </div>
            
            <!-- Items Table -->
            <div class="bg-white rounded-2xl shadow-sm overflow-hidden">
                <table class="w-full">
                    <thead class="bg-gray-50 border-b border-gray-200">
                        <tr>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase">–ù–∞—Ö–æ–¥–∫–∞</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase">–ê–≤—Ç–æ—Ä</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase">–°—Ç–∞—Ç—É—Å</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase">–î–∞—Ç–∞</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase">–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="itemsTableBody">
                        <!-- Filled by JS -->
                    </tbody>
                </table>
            </div>
            
        </section>

        <!-- Users Section -->
        <section id="section-users" class="p-6 hidden">
            
            <div class="bg-white rounded-2xl p-4 shadow-sm mb-6 flex flex-wrap gap-4 items-center">
                <input type="text" id="userSearch" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏..." 
                       class="flex-1 min-w-[200px] px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500">
                
                <select class="px-4 py-2 border border-gray-200 rounded-lg">
                    <option>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –ø–æ –∫–∞—Ä–º–µ</option>
                    <option>–ü–æ –¥–∞—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</option>
                    <option>–ü–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</option>
                </select>
            </div>
            
            <!-- Users Grid -->
            <div id="usersGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Filled by JS -->
            </div>
            
        </section>

        <!-- Reports Section -->
        <section id="section-reports" class="p-6 hidden">
            
            <div class="bg-white rounded-2xl p-4 shadow-sm mb-6 flex flex-wrap gap-4 items-center">
                <select id="reportStatus" class="px-4 py-2 border border-gray-200 rounded-lg" onchange="filterReports()">
                    <option value="">–í—Å–µ –∂–∞–ª–æ–±—ã</option>
                    <option value="pending">‚è≥ –ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</option>
                    <option value="resolved">‚úÖ –†–µ—à–µ–Ω–æ</option>
                    <option value="rejected">‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ</option>
                </select>
                
                <div class="flex-1"></div>
                
                <span class="text-sm text-gray-500" id="pendingCount">0 –æ–∂–∏–¥–∞—é—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è</span>
            </div>
            
            <!-- Reports List -->
            <div id="reportsList" class="space-y-4">
                <!-- Filled by JS -->
            </div>
            
        </section>

        <!-- Settings Section -->
        <section id="section-settings" class="p-6 hidden">
            
            <div class="max-w-2xl space-y-6">
                
                <!-- General Settings -->
                <div class="bg-white rounded-2xl p-6 shadow-sm">
                    <h3 class="font-bold text-gray-800 mb-4">‚öôÔ∏è –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è (—á–∞—Å–æ–≤)</label>
                            <input type="number" value="6" min="1" max="24" 
                                   class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–¥–∏—É—Å –ø–æ–∏—Å–∫–∞ (–∫–º)</label>
                            <input type="number" value="10" min="1" max="50" 
                                   class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500">
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="font-medium text-gray-700">–¢—Ä–µ–±–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ</p>
                                <p class="text-sm text-gray-500">–û–±—ä—è–≤–ª–µ–Ω–∏—è –±–µ–∑ —Ñ–æ—Ç–æ –Ω–µ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" checked class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-emerald-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500"></div>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Moderation Settings -->
                <div class="bg-white rounded-2xl p-6 shadow-sm">
                    <h3 class="font-bold text-gray-800 mb-4">üõ°Ô∏è –ú–æ–¥–µ—Ä–∞—Ü–∏—è</h3>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="font-medium text-gray-700">–ü—Ä–µ–º–æ–¥–µ—Ä–∞—Ü–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π</p>
                                <p class="text-sm text-gray-500">–ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-emerald-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500"></div>
                            </label>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="font-medium text-gray-700">–ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∏ –∂–∞–ª–æ–±–∞—Ö</p>
                                <p class="text-sm text-gray-500">–°–∫—Ä—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ 3 –∂–∞–ª–æ–±</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" checked class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:ring-4 peer-focus:ring-emerald-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-emerald-500"></div>
                            </label>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ó–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                            <textarea rows="3" placeholder="—Å–ø–∞–º, —Ä–µ–∫–ª–∞–º–∞, ..."
                                      class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500"></textarea>
                        </div>
                    </div>
                </div>
                
                <!-- Karma Settings -->
                <div class="bg-white rounded-2xl p-6 shadow-sm">
                    <h3 class="font-bold text-gray-800 mb-4">‚≠ê –°–∏—Å—Ç–µ–º–∞ –∫–∞—Ä–º—ã</h3>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ó–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏—é</label>
                            <input type="number" value="10" min="0" max="100" 
                                   class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ï—Å–ª–∏ –∑–∞–±—Ä–∞–ª–∏</label>
                            <input type="number" value="25" min="0" max="100" 
                                   class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ó–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ</label>
                            <input type="number" value="2" min="0" max="100" 
                                   class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ó–∞ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å</label>
                            <input type="number" value="5" min="0" max="100" 
                                   class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500">
                        </div>
                    </div>
                </div>
                
                <!-- Danger Zone -->
                <div class="bg-red-50 rounded-2xl p-6 border border-red-200">
                    <h3 class="font-bold text-red-800 mb-4">‚ö†Ô∏è –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h3>
                    
                    <div class="space-y-4">
                        <button onclick="clearExpired()" class="px-4 py-2 bg-red-100 text-red-700 rounded-lg text-sm font-semibold hover:bg-red-200">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
                        </button>
                        
                        <button onclick="exportAllData()" class="px-4 py-2 bg-blue-100 text-blue-700 rounded-lg text-sm font-semibold hover:bg-blue-200">
                            üì• –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
                        </button>
                        
                        <button onclick="resetDemo()" class="px-4 py-2 bg-gray-100 text-gray-700 rounded-lg text-sm font-semibold hover:bg-gray-200">
                            üîÑ –°–±—Ä–æ—Å–∏—Ç—å –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
                        </button>
                    </div>
                </div>
                
                <!-- Save Button -->
                <button onclick="saveSettings()" class="w-full py-3 bg-emerald-500 text-white font-bold rounded-xl hover:bg-emerald-600 transition">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
                
            </div>
        </section>

    </main>

    <script src="js/data.js"></script>
    <script>
        // === Admin Panel Logic ===
        
        let currentSection = 'dashboard';
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            Storage.init();
            loadDashboard();
            loadItems();
            loadUsers();
            loadReports();
        });
        
        // Navigation
        function showSection(sectionId) {
            currentSection = sectionId;
            
            // Hide all sections
            document.querySelectorAll('[id^="section-"]').forEach(s => s.classList.add('hidden'));
            
            // Show selected section
            const section = document.getElementById('section-' + sectionId);
            if (section) section.classList.remove('hidden');
            
            // Update nav
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('bg-emerald-600', 'text-white');
                link.classList.add('text-gray-300');
            });
            const activeLink = document.querySelector(`[href="#${sectionId}"]`);
            if (activeLink) {
                activeLink.classList.add('bg-emerald-600', 'text-white');
                activeLink.classList.remove('text-gray-300');
            }
            
            // Update title
            const titles = {
                'dashboard': 'üìä –î–∞—à–±–æ—Ä–¥',
                'items': 'üì¶ –û–±—ä—è–≤–ª–µ–Ω–∏—è',
                'users': 'üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏',
                'reports': '‚ö†Ô∏è –ñ–∞–ª–æ–±—ã',
                'settings': '‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏'
            };
            document.getElementById('sectionTitle').textContent = titles[sectionId] || sectionId;
        }
        
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
        }
        
        // Dashboard
        function loadDashboard() {
            const analytics = Data.getAnalytics();
            const items = Data.getItems();
            
            document.getElementById('stat-items').textContent = items.length;
            document.getElementById('stat-taken').textContent = items.filter(i => i.status === 'taken').length;
            document.getElementById('stat-users').textContent = analytics.totalUsers || 6;
            document.getElementById('stat-saved').textContent = analytics.savedKg || 156;
            
            // Recent activity
            const recentHtml = items.slice(0, 5).map(item => `
                <div class="flex items-center gap-4 p-3 bg-gray-50 rounded-xl">
                    <span class="text-2xl">${item.emoji || 'üì¶'}</span>
                    <div class="flex-1">
                        <p class="font-medium text-gray-800">${escapeHtml(item.title)}</p>
                        <p class="text-sm text-gray-500">${item.author?.name} ‚Ä¢ ${formatTimeAgo(item.createdAt)}</p>
                    </div>
                    <span class="status-badge status-${item.status}">
                        ${item.status === 'active' ? 'üü¢ –ê–∫—Ç–∏–≤–Ω–æ' : item.status === 'taken' ? '‚úÖ –ó–∞–±—Ä–∞–ª–∏' : '‚è∞ –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ'}
                    </span>
                </div>
            `).join('');
            document.getElementById('recentActivity').innerHTML = recentHtml || '<p class="text-gray-500">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</p>';
            
            // Charts
            renderCharts(items);
        }
        
        function renderCharts(items) {
            // Activity Chart
            const activityCtx = document.getElementById('activityChart');
            if (activityCtx) {
                new Chart(activityCtx, {
                    type: 'line',
                    data: {
                        labels: ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'],
                        datasets: [{
                            label: '–ü—É–±–ª–∏–∫–∞—Ü–∏–∏',
                            data: [3, 5, 2, 8, 4, 6, 7],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: true
                        }, {
                            label: '–ó–∞–±—Ä–∞–ª–∏',
                            data: [2, 3, 1, 6, 3, 5, 4],
                            borderColor: '#6366f1',
                            backgroundColor: 'rgba(99, 102, 241, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { position: 'bottom' } },
                        scales: { y: { beginAtZero: true } }
                    }
                });
            }
            
            // Categories Chart
            const catCtx = document.getElementById('categoriesChart');
            if (catCtx) {
                const catCounts = {};
                items.forEach(item => {
                    catCounts[item.category] = (catCounts[item.category] || 0) + 1;
                });
                
                new Chart(catCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['–ú–µ–±–µ–ª—å', '–ö–Ω–∏–≥–∏', '–¢–µ—Ö–Ω–∏–∫–∞', '–†–∞—Å—Ç–µ–Ω–∏—è', '–°—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã'],
                        datasets: [{
                            data: [
                                catCounts.furniture || 1,
                                catCounts.books || 1,
                                catCounts.electronics || 1,
                                catCounts.plants || 1,
                                catCounts.construction || 1
                            ],
                            backgroundColor: ['#f59e0b', '#6366f1', '#3b82f6', '#22c55e', '#f97316']
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { position: 'bottom' } }
                    }
                });
            }
        }
        
        // Items
        function loadItems() {
            const items = Data.getItems();
            renderItemsTable(items);
        }
        
        function renderItemsTable(items) {
            const tbody = document.getElementById('itemsTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = items.map(item => `
                <tr class="table-row border-b border-gray-100">
                    <td class="px-6 py-4">
                        <div class="flex items-center gap-3">
                            <span class="text-2xl">${item.emoji || 'üì¶'}</span>
                            <div>
                                <p class="font-medium text-gray-800">${escapeHtml(item.title)}</p>
                                <p class="text-sm text-gray-500">${item.location?.address || ''}</p>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-full bg-emerald-100 flex items-center justify-center text-sm font-medium">
                                ${item.author?.initial || '?'}
                            </div>
                            <span class="text-sm">${item.author?.name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</span>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <span class="status-badge status-${item.status}">
                            ${item.status === 'active' ? 'üü¢ –ê–∫—Ç–∏–≤–Ω–æ' : item.status === 'taken' ? '‚úÖ –ó–∞–±—Ä–∞–ª–∏' : '‚è∞ –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ'}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-500">
                        ${formatDate(item.createdAt)}
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex gap-2">
                            <button onclick="viewItem(${item.id})" class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg" title="–ü—Ä–æ—Å–º–æ—Ç—Ä">üëÅÔ∏è</button>
                            <button onclick="deleteItem(${item.id})" class="p-2 text-red-600 hover:bg-red-50 rounded-lg" title="–£–¥–∞–ª–∏—Ç—å">üóëÔ∏è</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }
        
        function filterItems() {
            const search = document.getElementById('itemSearch')?.value.toLowerCase() || '';
            const status = document.getElementById('itemStatus')?.value || '';
            const category = document.getElementById('itemCategory')?.value || '';
            
            let items = Data.getItems();
            
            if (search) {
                items = items.filter(i => i.title?.toLowerCase().includes(search));
            }
            if (status) {
                items = items.filter(i => i.status === status);
            }
            if (category) {
                items = items.filter(i => i.category === category);
            }
            
            renderItemsTable(items);
        }
        
        function viewItem(id) {
            const item = Data.getItem(id);
            if (item) {
                alert(`${item.emoji} ${item.title}\n\n${item.description}\n\nüìç ${item.location?.address}\nüë§ ${item.author?.name}\n‚è± ${formatDate(item.createdAt)}`);
            }
        }
        
        function deleteItem(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ?')) {
                Data.deleteItem(id);
                loadItems();
                loadDashboard();
            }
        }
        
        // Users
        function loadUsers() {
            const user = Data.getUser();
            const usersGrid = document.getElementById('usersGrid');
            if (!usersGrid) return;
            
            // Mock multiple users for demo
            const users = [
                user,
                { id: 101, name: '–ú–∏—Ö–∞–∏–ª', initial: '–ú', karma: 48, stats: { published: 5, taken: 3 } },
                { id: 102, name: '–ï–ª–µ–Ω–∞', initial: '–ï', karma: 156, stats: { published: 23, taken: 18 } },
                { id: 103, name: '–û–ª—å–≥–∞', initial: '–û', karma: 23, stats: { published: 2, taken: 1 } },
                { id: 104, name: '–ê–Ω–¥—Ä–µ–π', initial: '–ê', karma: 89, stats: { published: 11, taken: 7 } },
                { id: 105, name: '–°–µ—Ä–≥–µ–π', initial: '–°', karma: 234, stats: { published: 34, taken: 28 } }
            ];
            
            usersGrid.innerHTML = users.map(u => `
                <div class="bg-white rounded-2xl p-6 shadow-sm">
                    <div class="flex items-center gap-4 mb-4">
                        <div class="w-14 h-14 rounded-full bg-gradient-to-br from-emerald-400 to-teal-500 flex items-center justify-center text-white text-xl font-bold">
                            ${u.initial}
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-800">${u.name}</h4>
                            <p class="text-sm text-gray-500">${u.username || 'ID: ' + u.id}</p>
                        </div>
                    </div>
                    <div class="grid grid-cols-3 gap-2 text-center">
                        <div class="bg-gray-50 rounded-lg p-2">
                            <p class="font-bold text-emerald-600">${u.stats?.published || 0}</p>
                            <p class="text-xs text-gray-500">–ü—É–±–ª–∏–∫–∞—Ü–∏–π</p>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-2">
                            <p class="font-bold text-purple-600">${u.stats?.taken || 0}</p>
                            <p class="text-xs text-gray-500">–ó–∞–±—Ä–∞–ª–∏</p>
                        </div>
                        <div class="bg-gray-50 rounded-lg p-2">
                            <p class="font-bold text-amber-600">${u.karma}</p>
                            <p class="text-xs text-gray-500">–ö–∞—Ä–º–∞</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // Reports
        function loadReports() {
            const reports = Data.getReports();
            const reportsList = document.getElementById('reportsList');
            if (!reportsList) return;
            
            // Add some demo reports if empty
            const displayReports = reports.length > 0 ? reports : [
                { id: 1, itemId: 1, reason: 'fake', createdAt: Date.now() - 3600000, status: 'pending' },
                { id: 2, itemId: 4, reason: 'wrong_location', createdAt: Date.now() - 7200000, status: 'resolved' }
            ];
            
            const pending = displayReports.filter(r => r.status === 'pending').length;
            document.getElementById('pendingCount').textContent = `${pending} –æ–∂–∏–¥–∞—é—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è`;
            
            const reasonLabels = {
                'fake': 'üö´ –§–µ–π–∫ / –≤–µ—â–∏ –Ω–µ—Ç',
                'dangerous': '‚ö†Ô∏è –û–ø–∞—Å–Ω—ã–µ –æ—Ç—Ö–æ–¥—ã',
                'spam': 'üì¢ –°–ø–∞–º',
                'wrong_location': 'üìç –ù–µ–≤–µ—Ä–Ω–∞—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è',
                'inappropriate': 'üîû –ù–µ–ø—Ä–∏–µ–º–ª–µ–º—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç'
            };
            
            reportsList.innerHTML = displayReports.map(r => {
                const item = Data.getItem(r.itemId);
                return `
                    <div class="bg-white rounded-2xl p-4 shadow-sm flex items-center gap-4">
                        <span class="text-3xl">${item?.emoji || '‚ùì'}</span>
                        <div class="flex-1">
                            <p class="font-medium text-gray-800">${item?.title || '–£–¥–∞–ª—ë–Ω–Ω–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ'}</p>
                            <p class="text-sm text-gray-500">${reasonLabels[r.reason] || r.reason}</p>
                            <p class="text-xs text-gray-400">${formatTimeAgo(r.createdAt)}</p>
                        </div>
                        <span class="status-badge status-${r.status}">
                            ${r.status === 'pending' ? '‚è≥ –û–∂–∏–¥–∞–µ—Ç' : r.status === 'resolved' ? '‚úÖ –†–µ—à–µ–Ω–æ' : '‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ'}
                        </span>
                        ${r.status === 'pending' ? `
                            <div class="flex gap-2">
                                <button onclick="resolveReport(${r.id}, 'resolved')" class="p-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200" title="–£–¥–∞–ª–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ">‚úÖ</button>
                                <button onclick="resolveReport(${r.id}, 'rejected')" class="p-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200" title="–û—Ç–∫–ª–æ–Ω–∏—Ç—å –∂–∞–ª–æ–±—É">‚ùå</button>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }
        
        function filterReports() {
            const status = document.getElementById('reportStatus')?.value;
            let reports = Data.getReports();
            if (status) {
                reports = reports.filter(r => r.status === status);
            }
            // Re-render with filtered reports
            loadReports();
        }
        
        function resolveReport(reportId, status) {
            Data.updateReportStatus(reportId, status);
            if (status === 'resolved') {
                // Find and delete the item
                const reports = Data.getReports();
                const report = reports.find(r => r.id === reportId);
                if (report) {
                    Data.deleteItem(report.itemId);
                }
            }
            loadReports();
            loadDashboard();
        }
        
        // Settings actions
        function clearExpired() {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è?')) {
                const items = Data.getItems().filter(i => i.status !== 'expired');
                Storage.set('pomoechka_items', items);
                loadItems();
                loadDashboard();
                alert('–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω—ã');
            }
        }
        
        function exportAllData() {
            const data = Data.exportAllData();
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `pomoechka_export_${new Date().toISOString().slice(0,10)}.json`;
            a.click();
        }
        
        function exportItems() {
            const items = Data.getItems();
            const csv = 'ID,–ù–∞–∑–≤–∞–Ω–∏–µ,–ö–∞—Ç–µ–≥–æ—Ä–∏—è,–°—Ç–∞—Ç—É—Å,–ê–≤—Ç–æ—Ä,–ê–¥—Ä–µ—Å,–î–∞—Ç–∞\n' + 
                items.map(i => `${i.id},"${i.title}",${i.category},${i.status},"${i.author?.name}","${i.location?.address}",${formatDate(i.createdAt)}`).join('\n');
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'items.csv';
            a.click();
        }
        
        function resetDemo() {
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∫ –¥–µ–º–æ-–≤–µ—Ä—Å–∏–∏?')) {
                Storage.clear();
                Storage.init();
                location.reload();
            }
        }
        
        function saveSettings() {
            alert('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        }
        
        function refreshData() {
            loadDashboard();
            loadItems();
            loadUsers();
            loadReports();
            document.getElementById('lastUpdate').textContent = '–û–±–Ω–æ–≤–ª–µ–Ω–æ: —Å–µ–π—á–∞—Å';
        }
        
        // Helpers
        function escapeHtml(str = '') {
            return str
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;');
        }
        
        function formatTimeAgo(timestamp) {
            if (!timestamp) return '';
            const seconds = Math.floor((Date.now() - timestamp) / 1000);
            if (seconds < 60) return '—Ç–æ–ª—å–∫–æ —á—Ç–æ';
            if (seconds < 3600) return `${Math.floor(seconds / 60)} –º–∏–Ω –Ω–∞–∑–∞–¥`;
            if (seconds < 86400) return `${Math.floor(seconds / 3600)} —á –Ω–∞–∑–∞–¥`;
            return `${Math.floor(seconds / 86400)} –¥–Ω –Ω–∞–∑–∞–¥`;
        }
        
        function formatDate(timestamp) {
            if (!timestamp) return '';
            return new Date(timestamp).toLocaleDateString('ru-RU', {
                day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit'
            });
        }
    </script>

</body>
</html>
